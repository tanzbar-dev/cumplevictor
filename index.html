<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aventura de Cumpleaños de Víctor</title>
    <!-- Incluye Tailwind CSS para un estilo rápido y responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Cargamos una fuente de Google Fonts más aventurera y legible -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para un look más "de explorador" */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #261e1b; /* Marrón oscuro, como la tierra */
            color: #f0f0c0; /* Texto en color crema para simular un pergamino */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        /* El contenedor principal ahora no tiene un ancho máximo fijo */
        .container-card {
            background: linear-gradient(145deg, #3c302a, #261e1b); /* Degradado en tonos tierra */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: fadeIn 1.2s ease-in-out;
            border: 2px solid #6a4f41; /* Borde de color marrón claro */
            width: 100%;
        }
        /* Clase base para todas las páginas con padding */
        .page-content {
            display: none; /* Oculta todas las páginas por defecto */
            transition: opacity 0.5s ease-in-out;
            padding: 2.5rem;
            position: relative;
            text-align: center; /* Centramos el contenido por defecto */
        }
        /* Nueva clase para las páginas con video, sin padding horizontal para que el video ocupe el 100% */
        .page-content.video-page {
            padding: 0;
        }
        .page-content.active {
            display: block; /* Muestra solo la página activa */
            animation: slideIn 0.8s forwards;
        }
        /* Contenedor interno para el texto y otros elementos, con ancho limitado y padding */
        .content-wrapper {
            max-width: 60rem; /* max-w-4xl en Tailwind */
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            padding: 2.5rem; /* El padding se aplica aquí, no en el padre */
        }
        h1, h2 {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            color: #d4b882; /* Tono dorado/bronce para títulos */
        }
        .video-responsive {
            position: relative;
            padding-bottom: 56.25%; /* Mantiene una relación de aspecto de 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 16px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            width: 100%;
            margin: 0 auto;
        }
        .video-responsive iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .adventure-button {
            background: linear-gradient(90deg, #4a7c59, #6a4f41); /* Degradado de verde a marrón */
            border-radius: 9999px;
            padding: 1rem 2rem;
            font-weight: 700;
            color: white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 10px rgba(74, 124, 89, 0.3);
            transform: scale(1);
        }
        .adventure-button:hover {
            background: linear-gradient(90deg, #3b6b4e, #5a4136);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 20px rgba(74, 124, 89, 0.4);
        }
        input[type="text"], input[type="number"] {
            background-color: #3c302a; /* Fondo más oscuro para el input */
            color: #f0f0c0;
            border: 1px solid #6a4f41;
            transition: all 0.3s ease;
        }
        input[type="text"]:focus, input[type="number"]:focus {
            border-color: #4a7c59;
            box-shadow: 0 0 0 3px rgba(74, 124, 89, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #3c302a;
            border: 2px solid #d4b882;
            padding: 2rem;
            border-radius: 10px;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            animation: zoomIn 0.3s forwards;
            display: none; /* Hidden by default */
        }
        @keyframes zoomIn {
            from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            display: none;
        }
    </style>
</head>
<body>

<div class="overlay" id="overlay"></div>
<div class="message-box text-center" id="message-box">
    <p id="message-text" class="text-xl mb-6"></p>
    <button onclick="closeMessageBox()" class="adventure-button">Cerrar</button>
</div>

<div class="container-card mx-auto p-6 md:p-12 rounded-2xl flex flex-col items-center">

    <!-- Etapa 0: Pantalla de Bienvenida (La caja inicial) -->
    <div id="stage-0" class="page-content">
        <div class="content-wrapper">
            <h1 class="text-3xl md:text-5xl font-bold mb-4">¡¡¡¡Feliz cumpleaños pequeño buscador de tesoros!!!!</h1>
            <p class="text-lg md:text-xl mb-8">
                El día de hoy tienes una misión llena de retos, peligros y recompensas que solo puedes aceptar si es tu cumpleaños! estas listo para aceptarla?!? piensalo bien y da click en comenzar... solo recuerda que si aceptas no hay vuelta atras!
            </p>
            <div class="w-full h-auto max-w-sm mx-auto mb-8 rounded-lg overflow-hidden">
                <img src="https://raw.githubusercontent.com/tanzbar-dev/cumplevictor/main/cumplehuguito.jpeg" 
                    alt="Imagen de feliz cumpleaños, con temática de búsqueda del tesoro" 
                    class="w-full h-auto object-cover">
            </div>
            <button id="start-button" class="adventure-button" onclick="goToStage(1)">
                Comenzar la Aventura
            </button>
        </div>
    </div>

    <!-- Etapa 1: Video de Bienvenida y Primera Pista -->
    <div id="stage-1" class="page-content video-page">
        <div class="video-responsive w-full rounded-xl overflow-hidden mb-8">
            <iframe id="youtube-player-1" width="100%" height="100%" src="https://www.youtube.com/embed/OXNgMQbK_R8?autoplay=1&mute=0&rel=0" title="Video de bienvenida con temática de aventura" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">Feliz cumpleaños explorador Victor!</h2>
            <p class="text-base md:text-lg mb-4">
                Para avanzar tienes que pensar cuidadosamente y resolver este acertijo: <br>
                ¿dónde creas tus ideas? ¿dónde estudias, dibujas, diseñas? piensa en ese lugar y dirigete hacia alla!. Ese es tu primer reto.
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(2)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 2: Reto de la Tablet (Con formulario de respuesta) -->
    <div id="stage-2" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">El Enigma del Guardián Rectangular</h2>
            <p class="text-base md:text-lg mb-4">
                "Soy rectangular, pero no soy pizza. Tengo teclas, pero no soy piano. ¿Quién soy?"
            </p>
            <input type="text" id="answer-input" class="w-full md:w-2/3 lg:w-1/2 p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" placeholder="Escribe tu respuesta aquí...">
            <button id="answer-button" class="adventure-button bg-purple-600 hover:bg-purple-700">
                Desbloquear Pista
            </button>
            <div id="feedback" class="mt-4 text-red-400 font-semibold"></div>
        </div>
    </div>

    <!-- Etapa 3: Pista para encontrar la tablet -->
    <div id="stage-3" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Acertaste!</h2>
            <p class="text-base md:text-lg mb-4">
                ¡Acertaste! Busca en el tercer cajón del closet que tienes al lado izquierdo tu recompensa.
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(4)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 4: Pista de la Playera Moschino (sin botón) -->
    <div id="stage-4" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡¡Pero te peinas!!</h2>
            <p class="text-base md:text-lg mb-4">
                Un buen explorador nunca descuida su arreglo personal. Ve a vestirte, arréglate y… ¡prepárate para la aventura!
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(5)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 5: Acertijo del Pádel -->
    <div id="stage-5" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¿Eres lo suficientemente hábil?</h2>
            <p class="text-base md:text-lg mb-4">
                El siguiente acertijo te llevará a tu siguiente aventura: <br><br>
                No es la playa pero tiene arena, <br>
                ahí usas una pala pero no para la tierra, <br>
                hay una red pero no es de pescar, <br>
                y 4 paredes para rebotar. <br><br>
                Si quieres encontrar tu siguiente señal, <br>
                ve a donde juegas con banana y tu papá <br>
                y pregunta en recepción que seguirá!
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(6)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 6: Reto del Club de Pádel (sin video) -->
    <div id="stage-6" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">Reto: Club de Pádel</h2>
            <p class="text-base md:text-lg mb-4">
                "Es hora de poner tu cuerpo en acción. Dirígete a la cancha. Ahí te espera el verdadero desafío físico. Pero ojo: solo los que apuntan con precisión desbloquean su destino."
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(7)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 7: Mensaje de Cibó (sin botón) -->
    <div id="stage-7" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Vas muy bien!</h2>
            <p class="text-base md:text-lg mb-4">
                Pero ya se te debe estar agotando la energía. Ve a Cibó y come algo para continuar tu travesía.
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(8)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 8: Pista para La Joye (sin video) -->
    <div id="stage-8" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡La aventura no ha terminado!</h2>
            <p class="text-base md:text-lg mb-4">
                "Pensaste que ya había terminado la aventura?! pues estas equivocado! Tienes un acertijo más! Piensa y acertarás, el lugar a donde te encaminarás es donde los sueños se construyen con esfuerzo y mucho trabajo!! Si estás dispuesto a trabajar para cumplir tus sueños ya sabes a donde debes ir!!"
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(9)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 9: Reto de las medallas en La Joye -->
    <div id="stage-9" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Aquí no basta con verse bien!</h2>
            <p class="text-base md:text-lg mb-4">
                Aquí no basta con ser inteligente o verse bien, hay que trabajar para ganarse las cosas!! Tu siguiente reto es contar cuantas medallas hay en la joye si aciertas puedes avanzar!
            </p>
            <input type="number" id="medallas-input" class="w-full md:w-2/3 lg:w-1/2 p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" placeholder="Escribe el número de medallas aquí...">
            <button id="medallas-button" class="adventure-button bg-purple-600 hover:bg-purple-700">
                Comprobar
            </button>
            <div id="medallas-feedback" class="mt-4 text-red-400 font-semibold"></div>
        </div>
    </div>

    <!-- Etapa 10: Pista para la recompensa de La Joye -->
    <div id="stage-10" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Respuesta correcta!</h2>
            <p class="text-base md:text-lg mb-4">
                Ve a la parte de atrás y busca tu recompensa!
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(11)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 11: Mensaje para regresar a la casa -->
    <div id="stage-11" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Explorador Víctor necesitamos su ayuda!</h2>
            <p class="text-base md:text-lg mb-4">
                regrese a la base de exploradores inmediatamente!!
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(12)">Siguiente</button>
        </div>
    </div>

    <!-- Etapa 12: Acertijo final del cofre del tesoro -->
    <div id="stage-12" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡El Secreto del Cofre!</h2>
            <p class="text-base md:text-lg mb-4">
                "Felicitaciones nuevamente no solo por tu cumpleaños sino por haber llegado hasta aquí! Sin embargo necesito tu ayuda! He encontrado un cofre del tesoro muy antiguo en una cueva misteriosa, pero tiene un candado con combinación numérica de 3 dígitos y no logro resolverlo."
            </p>
            <p class="text-base md:text-lg mb-4">
                "Junto al cofre encontré este pergamino con un acertijo que dice: <br><br>
                'El sabio guardián era un gran matemático. Antes de esconder su tesoro, hizo este cálculo secreto:
                - Tomó el número de años que tiene un siglo (100)
                - Lo multiplicó por el número de lados que tiene un triángulo (3)
                - Al resultado le sumó el número de días que tiene un año bisiesto (366)
                - Finalmente, le restó el número de días que tiene un año normal (365)
                El resultado de esta operación es la clave del candado.' <br><br>
                Explorador, he intentado resolver este acertijo muchas veces pero me confundo con los cálculos. ¿Podrías ayudarme paso a paso? Una vez que encuentres el número correcto, podremos abrir el candado y descubrir qué tesoro esconde el cofre."
            </p>
            <p class="text-base md:text-lg mb-4">
                "¿Cuál crees que es la combinación secreta?"
            </p>
            <button class="adventure-button bg-green-600 hover:bg-green-700 mt-8" onclick="goToStage(13)">
                ¡Resolver el acertijo!
            </button>
        </div>
    </div>

    <!-- Etapa 13: Ingresar la combinación del cofre -->
    <div id="stage-13" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">El Cofre Misterioso</h2>
            <p class="text-base md:text-lg mb-4">
                Ahora que tienes el acertijo, ¿cuál es el número de 3 dígitos que abre el candado?
            </p>
            <input type="number" id="cofre-input" class="w-full md:w-2/3 lg:w-1/2 p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" placeholder="Escribe la combinación aquí (ej: 123)">
            <button id="cofre-button" class="adventure-button bg-purple-600 hover:bg-purple-700">
                Abrir Cofre
            </button>
            <div id="cofre-feedback" class="mt-4 text-red-400 font-semibold"></div>
        </div>
    </div>

    <!-- Etapa 14: Felicitaciones del narrador (sin video, solo texto) -->
    <div id="stage-14" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Tesoro Desbloqueado!</h2>
            <p class="text-base md:text-lg mb-4">
                ¡Lo lograste! El cofre se ha abierto. ¡Feliz cumpleaños, Víctor! ¡Has completado esta aventura con éxito! Ahora, ¡a disfrutar de tu recompensa!
            </p>
            <button class="adventure-button mt-8" onclick="goToStage(15)">Finalizar</button>
        </div>
    </div>

    <!-- Etapa 15: Mensaje de fin de aventura -->
    <div id="stage-15" class="page-content">
        <div class="content-wrapper">
            <h2 class="text-2xl md:text-4xl font-semibold mb-6">¡Aventura completa!</h2>
            <p class="text-base md:text-lg mb-4">
                Gracias por completar esta emocionante aventura. ¡Esperamos que hayas disfrutado de tu día especial!
            </p>
        </div>
    </div>

</div>

<script>
    // Variable para la etapa actual, se inicializa en 0
    let currentStage = 0;

    // Función para mostrar un mensaje emergente
    function showMessageBox(message) {
        document.getElementById('message-text').innerText = message;
        document.getElementById('overlay').style.display = 'block';
        document.getElementById('message-box').style.display = 'block';
    }

    // Función para cerrar el mensaje emergente
    function closeMessageBox() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('message-box').style.display = 'none';
    }

    // Función principal para cambiar de etapa
    function goToStage(stageNumber) {
        // Aseguramos que la etapa es un número y está dentro del rango
        // Se ha actualizado el rango para incluir la etapa 15
        if (typeof stageNumber !== 'number' || stageNumber < 0 || stageNumber > 15) {
            console.error("Etapa inválida:", stageNumber);
            return;
        }

        // Ocultar todas las páginas
        document.querySelectorAll('.page-content').forEach(element => {
            element.classList.remove('active');
        });

        // Mostrar solo la página correcta
        currentStage = stageNumber;
        const newStageElement = document.getElementById(`stage-${currentStage}`);
        
        // CORRECCIÓN: Se añade una validación para evitar errores si el elemento no existe (problema de caché)
        if (newStageElement) {
            newStageElement.classList.add('active');
        } else {
            console.error(`Error: No se encontró la etapa con ID 'stage-${currentStage}'`);
            // Regresar a la pantalla de inicio si la etapa no existe
            const defaultStageElement = document.getElementById('stage-0');
            if (defaultStageElement) {
                defaultStageElement.classList.add('active');
            }
        }
        
        // Desplazar la vista al principio de la página
        window.scrollTo(0, 0);

        // Lógica específica para videos
        if (currentStage === 1) {
            const videoPlayer = document.getElementById('youtube-player-1');
            if (videoPlayer) {
                // Reinicia el video para que comience automáticamente si se regresa a esta etapa
                videoPlayer.src = videoPlayer.src;
            }
        }
    }

    // Lógica para el Reto de la Tablet (Etapa 2)
    document.getElementById('answer-button').addEventListener('click', function() {
        const answer = document.getElementById('answer-input').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback');
        if (answer === "tablet" || answer === "la tablet") {
            feedback.innerText = "";
            goToStage(3); // Pasar a la siguiente etapa
        } else {
            feedback.innerText = "¡Respuesta incorrecta! Intenta de nuevo.";
        }
    });

    // Lógica para el Reto de las Medallas (Etapa 9)
    document.getElementById('medallas-button').addEventListener('click', function() {
        const answer = document.getElementById('medallas-input').value.trim();
        const feedback = document.getElementById('medallas-feedback');
        // La respuesta correcta se ha cambiado a 38
        if (answer === "38") {
            feedback.innerText = "";
            goToStage(10); // Pasar a la siguiente etapa
        } else {
            feedback.innerText = "¡Número incorrecto! El tesoro no se desbloqueará así de fácil.";
        }
    });

    // Lógica para el Reto del Cofre (Etapa 13)
    document.getElementById('cofre-button').addEventListener('click', function() {
        const answer = document.getElementById('cofre-input').value.trim();
        const feedback = document.getElementById('cofre-feedback');
        // Cálculo del acertijo: (100 * 3) + 366 - 365 = 300 + 1 = 301
        if (answer === "301") {
            feedback.innerText = "";
            goToStage(14); // Pasar a la etapa final
        } else {
            feedback.innerText = "¡La combinación es incorrecta! Intenta de nuevo.";
        }
    });

    // Llama a esta función al cargar la página para determinar la etapa inicial
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const stageParam = urlParams.get('stage');
        let initialStage = 0; // La etapa inicial por defecto es 0
        if (stageParam) {
            const stageNumber = parseInt(stageParam);
            // Si el parámetro es un número válido, lo usamos como etapa inicial
            // Se ha actualizado el rango para incluir la etapa 15
            if (!isNaN(stageNumber) && stageNumber >= 0 && stageNumber <= 15) {
                initialStage = stageNumber;
            }
        }
        // Navegamos a la etapa inicial correcta
        goToStage(initialStage);
    };

</script>

</body>
</html>
